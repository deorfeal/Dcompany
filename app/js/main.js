jQuery(document).ready(function () {

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MixItUp
    if (document.querySelector('.portfolio__wrapper')) {
        var mixer = mixitup('.portfolio__wrapper', {
            load: {
                filter: '.best'
            },
            animation: {
                enable: true
            },
            callbacks: {
                onMixEnd: function (state) {
                    // –†–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AOS –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
                    AOS.refresh();
                }
            }
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è span
    function updateButtonCounts() {
        // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
        const filters = {
            all: 0,
            best: 0,
            land: 0,
            'internet-shop': 0,
            animated: 0,
            multipage: 0,
            quiz: 0
        };

        // –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
        for (let filter in filters) {
            filters[filter] = document.querySelectorAll(`.mix.${filter}`).length;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        for (let filter in filters) {
            const button = document.querySelector(`.tubs__button[data-filter=".${filter}"]`);
            if (button) {
                const span = button.querySelector('span');
                if (span) {
                    span.textContent = ` (${filters[filter]})`;
                }
            }
        }
    }

    // –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    updateButtonCounts();

    function isMobileDevice() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    const once = isMobileDevice() ? true : false;

    (function () {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AOS
        AOS.init({
            duration: 750,
            offset: 0, // —Å–º–µ—â–µ–Ω–∏–µ (–≤ –ø–∏–∫—Å–µ–ª—è—Ö) –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
            anchorPlacement: 'top-bottom', // –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–¥–µ –±—É–¥—É—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ AOS
            once: once
        });
    })();
});

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
const lang = document.documentElement.lang;

function createNotificationContainer() {
    let container = document.querySelector('.notifications');
    if (!container) {
        container = document.createElement('div');
        container.className = 'notifications';
        document.body.appendChild(container);
    }
    return container;
}

// –í—ã–∑—ã–≤–∞–µ–º –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
const notificationContainer = createNotificationContainer();

let notificationCount = 0;
function showNotification(message, type) {
    const notificationsContainer = document.querySelector('.notifications');
    const notification = document.createElement('div');
    notification.className = `notification ${type} show`;
    notification.innerText = message;

    notificationsContainer.appendChild(notification);
    updatePositions();

    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
            notification.remove();
            updatePositions();
        }, 300);
    }, 3000);
}

function updatePositions() {
    const notifications = document.querySelectorAll('.notification');
    notifications.forEach((el, index) => {
        el.style.transform = `translateY(${index * 60}px)`;
    });
}

document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("contactForm");
    if (!form) {
        return;
    }

    form.addEventListener("submit", function (e) {
        e.preventDefault(); // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã

        // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã
        const nameInput = document.getElementById("name");
        const contactInput = document.querySelector(".contact-form__box-input#contact");
        const messageInput = document.getElementById("message");
        const consentCheckbox = document.getElementById("consent");
        const consentCheckboxElement = document.querySelector(".contact .checkmark");

        let isValid = true;

        function getValue(input) {
            return input && input.value ? input.value.trim() : "";
        }

        function showError(input, message) {
            if (input) {
                input.classList.add("error-field");
                input.setAttribute("data-error", message);
            }
            isValid = false;
        }

        function clearError(input) {
            if (input) {
                input.classList.remove("error-field");
                input.removeAttribute("data-error");
            }
        }

        // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
        const nameValue = getValue(nameInput);
        const contactValue = getValue(contactInput);
        const messageValue = getValue(messageInput);

        if (nameValue === "") {
            if (lang === 'en') {
                showNotification("Enter your name", "error"), showError(nameInput);
            } else {
                showNotification("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è", "error"), showError(nameInput);
            }
        } else {
            clearError(nameInput);
        }

        if (contactValue === "") {
            if (lang === 'en') {
                showNotification("Enter your contact", "error"), showError(contactInput);
            } else {
                showNotification("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–æ–Ω—Ç–∞–∫—Ç", "error"), showError(contactInput);
            }

        } else {
            clearError(contactInput);
        }


        if (messageValue === "") {
            if (lang === 'en') {
                showNotification("Enter your question", "error"), showError(messageInput);
            } else {
                showNotification("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å", "error"), showError(messageInput);
            }
        } else {
            clearError(messageInput);
        }

        if (!consentCheckbox || !consentCheckbox.checked) {
            if (lang === 'en') {
                showNotification("Please accept our privacy policy", "error");
            } else {
                showNotification("–ü–æ–∂–∞–ª—É–∏ÃÜ—Å—Ç–∞, –ø—Ä–∏–Ω–∏–º–∏—Ç–µ –Ω–∞—à—É –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ ", "error");
            }

            showError(consentCheckboxElement);
            isValid = false;
        } else {
            clearError(consentCheckboxElement);
        }

        if (!isValid) return; // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
        const BOT_TOKEN = "7918877031:AAEv9vqtG-sDgyI_SMY80EoD0jZ90uA4R5A";
        const CHAT_ID = "624283568";
        const text = `üì© –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:\nüë§ –ò–º—è: ${nameValue}\n‚úâÔ∏è –ö–æ–Ω—Ç–∞–∫—Ç: ${contactValue}\nüìù –í–æ–ø—Ä–æ—Å: ${messageValue}`;

        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ chat_id: CHAT_ID, text: text, parse_mode: "HTML" })
        })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    if (lang === 'en') {
                        showNotification("Message sent successfully!", "success");
                    } else {
                        showNotification("–°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!", "success");
                    }

                    form.reset();
                } else {
                    if (lang === 'en') {
                        showNotification("Message sending error", "error");
                    } else {
                        showNotification("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è", "error");
                    }
                }
            })
            .catch(() => {
                if (lang === 'en') {
                    showNotification("Message sending error", "error");
                } else {
                    showNotification("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è", "error");
                }
            });
    });
});


$(document).on('scroll', function () {
    var $footer = $('.footer');
    var $socials = $('.socials');
    var footerTop = $footer.offset().top;
    var footerBottom = footerTop + $footer.outerHeight();
    var windowBottom = $(window).scrollTop() + $(window).height();

    if (windowBottom > footerTop && $(window).scrollTop() < footerBottom) {
        $socials.addClass('socials--disabled');
    } else {
        $socials.removeClass('socials--disabled');
    }
});

// 

document.addEventListener('DOMContentLoaded', function () {
    const duration = 1500; // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö

    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º score-item__digit
    const targets = document.querySelectorAll('.counter');

    // –°–æ–∑–¥–∞–µ–º Observer
    let observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                // –ù–∞—á–∏–Ω–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
                const target = entry.target;
                const endValue = parseFloat(target.getAttribute('data-value'));
                startCounter(target, endValue, duration);
                observer.unobserve(target);
            }
        });
    });

    // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∫–∞–∂–¥—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
    targets.forEach(target => observer.observe(target));

    function startCounter(element, endValue, duration) {
        let startValue = 0;
        let startTime = null;

        function updateCounter(currentTime) {
            if (!startTime) startTime = currentTime;
            let progress = currentTime - startTime;
            let currentValue = Math.min(endValue, startValue + (progress / duration) * (endValue - startValue));
            element.textContent = Math.round(currentValue);

            if (currentValue < endValue) {
                requestAnimationFrame(updateCounter);
            } else {
                element.textContent = Math.round(endValue);
            }
        }

        requestAnimationFrame(updateCounter);
    }
});

// 

$(function () {

    $('.socials').on('click', function (event) {
        event.stopPropagation(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è
        $(this).toggleClass('socials--active');
    });

    $(document).on('click', function () {
        $('.socials').removeClass('socials--active');
    });

    $('.faq-list__item').on('click', function (event) {
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        $('.faq-list__item--active').not(this).removeClass('faq-list__item--active');

        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –∫–ª–∏–∫–Ω—É–ª–∏
        $(this).toggleClass('faq-list__item--active');
    });

    $('.burger').on('click', function (event) {
        $('body').toggleClass('body--menu');
    });

    $('.menu__list-link').on('click', function (event) {
        $('body').removeClass('body--menu');
    });

})

$(function () {
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    function isMobileDevice() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    // –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–±–∏–ª—å–Ω–æ–µ, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞
    if (isMobileDevice()) {
        $(document).on('click', function (event) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ü–µ–ª—å –∫–ª–∏–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–º —Å –∫–ª–∞—Å—Å–æ–º '.lang'
            if (!$(event.target).closest('.lang').length) {
                // –ï—Å–ª–∏ –Ω–µ—Ç, —É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å 'lang--active' —É –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —ç—Ç–∏–º –∫–ª–∞—Å—Å–æ–º
                $('.lang').removeClass('lang--active');
            } else {
                // –ò–Ω–∞—á–µ –¥–æ–±–∞–≤–ª—è–µ–º/—É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å 'lang--active' –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–ª–∞—Å—Å–æ–º '.lang'
                $(event.target).closest('.lang').toggleClass('lang--active');
            }
        });
    } else { // –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–±—ã—Ç–∏–µ —Ö–æ–≤–µ—Ä–∞
        $('.lang').on('mouseover', function () {
            $(this).addClass('lang--active');
        });

        $('.lang').on('mouseout', function () {
            $(this).removeClass('lang--active');
        });
    }
});

// –ú–∞—Å—Å–∏–≤—ã —Å—Ç—Ä–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤
const strings = lang === 'en'
    ? ["I'm a Front-end developer", "I'm a Web Designer", "I'm not afraid of Back-end", "I'll strengthen your team!"]
    : ["–Ø Front-end developer", "–Ø Web Designer", "–Ø –Ω–µ –±–æ—é—Å—å Back-end", "–Ø —É—Å–∏–ª—é –í–∞—à—É –∫–æ–º–∞–Ω–¥—É!"];

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Typed.js
$(".typed").typed({
    strings: strings,
    stringsElement: null,
    typeSpeed: 30,
    startDelay: 250,
    backSpeed: 30,
    backDelay: 500,
    loop: true,
    loopCount: 2,
    showCursor: true,
    cursorChar: "|",
    attr: null,
    contentType: 'text',
    callback: function () { },
    preStringTyped: function () { },
    onStringTyped: function () { },
    resetCallback: function () { }
});


let codeSwiper = new Swiper('.code-swiper', {
    slidesPerView: 3.5,
    loop: true,
    initialSlide: 0,
    centeredSlides: true,
    speed: 750,
    direction: 'vertical',
    spaceBetween: 4,
    autoplay: {
        delay: 2000, // Set the delay (in milliseconds) between each slide transition
        disableOnInteraction: false, // Set to true to keep autoplay running even when the user interacts with the slider (e.g., swipes manually)
    },
    breakpoints: {
        320: {
            slidesPerView: 1.5,
            loop: true,
            initialSlide: 0,
            centeredSlides: false,
            speed: 750,
            direction: 'horizontal',
            spaceBetween: 12,
        },
        551: {
            slidesPerView: 1.75,
            loop: true,
            initialSlide: 0,
            centeredSlides: false,
            speed: 750,
            direction: 'horizontal',
            spaceBetween: 12,
        },
        651: {
            slidesPerView: 2.5,
            loop: true,
            initialSlide: 0,
            centeredSlides: false,
            speed: 750,
            direction: 'horizontal',
            spaceBetween: 12,
        },
        801: {
            slidesPerView: 3.5,
            loop: true,
            initialSlide: 0,
            centeredSlides: true,
            speed: 750,
            direction: 'vertical',
            spaceBetween: 4,
        },
    }
});

codeSwiper.on('slideChange', function () {
    document.querySelector('.code-swiper').classList.add('code-swiper--active');
});

let codeSwiperContainer = document.querySelector('.code-swiper');

if (codeSwiperContainer) {
    codeSwiperContainer.addEventListener('mouseenter', function () {
        codeSwiper.autoplay.stop();
    });

    codeSwiperContainer.addEventListener('mouseleave', function () {
        codeSwiper.autoplay.start();
    });
}

new Swiper('.skills-swiper--first', {
    slidesPerView: 7,
    loop: true,
    initialSlide: 0,
    centeredSlides: true,
    speed: 750,
    spaceBetween: 20,
    autoplay: {
        delay: 750, // Set the delay (in milliseconds) between each slide transition
        disableOnInteraction: false, // Set to true to keep autoplay running even when the user interacts with the slider (e.g., swipes manually)
    },
    // breakpoints: {
    //     301: {
    //         slidesPerView: 2.2,
    //         centeredSlides: true,
    //         initialSlide: 1,
    //         slidesPerGroup: 1,
    //         loopedSlides: 6,
    //     },
    //     501: {
    //         slidesPerView: 2.5,
    //         centeredSlides: true,
    //         initialSlide: 1,
    //         slidesPerGroup: 1,
    //         loopedSlides: 6,
    //     },
    // }
});

new Swiper('.skills-swiper--second', {
    slidesPerView: 7,
    loop: true,
    initialSlide: 0,
    centeredSlides: true,
    speed: 750,
    spaceBetween: 20,
    // direction: 'vertical',
    autoplay: {
        reverseDirection: true,
        delay: 750, // Set the delay (in milliseconds) between each slide transition
        disableOnInteraction: false, // Set to true to keep autoplay running even when the user interacts with the slider (e.g., swipes manually)
    },
    // breakpoints: {
    //     301: {
    //         slidesPerView: 2.2,
    //         centeredSlides: true,
    //         initialSlide: 1,
    //         slidesPerGroup: 1,
    //         loopedSlides: 6,
    //     },
    //     501: {
    //         slidesPerView: 2.5,
    //         centeredSlides: true,
    //         initialSlide: 1,
    //         slidesPerGroup: 1,
    //         loopedSlides: 6,
    //     },
    // }
});


let testimonialsSwiper = new Swiper('.testimonials-swiper', {
    slidesPerView: 3,
    loop: true,
    initialSlide: 1,
    centeredSlides: true,
    speed: 1000,
    spaceBetween: 20,
    autoplay: {
        delay: 1000, // Delay between slides in milliseconds (3 seconds in this example)
        disableOnInteraction: false, // Autoplay continues even when the user interacts with the slider
    },
    // navigation: {
    //     prevEl: '.catalog-first-swiper-button-prev',
    //     nextEl: '.catalog-first-swiper-button-next',
    // },
    // pagination: {
    //     el: '.recalls-swiper__pagination',
    //     type: 'bullets',
    // },
    breakpoints: {
        301: {
            slidesPerView: 1.2,
            loop: true,
            initialSlide: 1,
            centeredSlides: true,
            speed: 1000,
            spaceBetween: 15,
        },
        551: {
            slidesPerView: 2.2,
            loop: true,
            initialSlide: 1,
            centeredSlides: true,
            speed: 1000,
            spaceBetween: 15,
        },
        751: {
            slidesPerView: 3.2,
            loop: true,
            initialSlide: 1,
            centeredSlides: true,
            speed: 1000,
            spaceBetween: 15,
        },
        1351: {
            slidesPerView: 3,
            loop: true,
            initialSlide: 1,
            centeredSlides: true,
            speed: 1000,
            spaceBetween: 20,
        },
    }
});

let testimonialsSwiperContainer = document.querySelector('.testimonials-swiper');

if (testimonialsSwiperContainer) {
    testimonialsSwiperContainer.addEventListener('mouseenter', function () {
        testimonialsSwiper.autoplay.stop();
    });

    testimonialsSwiperContainer.addEventListener('mouseleave', function () {
        testimonialsSwiper.autoplay.start();
    });
}

